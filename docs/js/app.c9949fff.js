(function(e){function t(t){for(var r,o,u=t[0],i=t[1],s=t[2],l=0,b=[];l<u.length;l++)o=u[l],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&b.push(c[o][0]),c[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);f&&f(t);while(b.length)b.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==c[i]&&(r=!1)}r&&(a.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},c={app:0},a=[];function o(e){return u.p+"js/"+({}[e]||e)+"."+{"chunk-4debf6f7":"dea66444","chunk-2d0c4813":"971bc08f","chunk-2d2086b7":"95b1f028","chunk-88fba9f8":"599ac620"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n=c[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=c[e]=[t,r]}));t.push(n[2]=r);var a,i=document.createElement("script");i.charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.src=o(e);var s=new Error;a=function(t){i.onerror=i.onload=null,clearTimeout(l);var n=c[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",s.name="ChunkLoadError",s.type=r,s.request=a,n[1](s)}c[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:i})}),12e4);i.onerror=i.onload=a,document.head.appendChild(i)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/nane-client/",u.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var f=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0613":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return C}));var r,c,a=n("5502"),o=n("ade3"),u=n("1da1"),i=(n("96cf"),n("498a"),n("d058")),s=n.n(i),l=n("afbc");n("c740"),n("b0c0");(function(e){e["SetUsername"]="SET_USERNAME",e["SetSettings"]="SET_SETTINGS",e["SetRooms"]="SET_ROOMS",e["SetHistory"]="SET_HISTORY",e["SetCurrentRoom"]="SET_CURRENT_ROOM",e["CreateRoom"]="CREATE_ROOM",e["ProcessMessage"]="PROCESS_MESSAGE"})(c||(c={}));var f=(r={},Object(o["a"])(r,c.SetUsername,(function(e,t){e.username=t})),Object(o["a"])(r,c.SetSettings,(function(e,t){e.settings=t})),Object(o["a"])(r,c.SetRooms,(function(e,t){e.rooms=t})),Object(o["a"])(r,c.SetHistory,(function(e,t){e.history=t})),Object(o["a"])(r,c.SetCurrentRoom,(function(e,t){e.currentRoom=t})),Object(o["a"])(r,c.ProcessMessage,(function(e,t){var n,r,c=t.roomName,a=t.message;if(e.rooms){var o,u=null===(n=e.rooms)||void 0===n?void 0:n.findIndex((function(e){return e.name===c}));if(-1!==u?e.rooms[u].lastMessage=a:e.rooms.push({name:c,lastMessage:a}),(null===(r=e.currentRoom)||void 0===r?void 0:r.name)===c)null===(o=e.history)||void 0===o||o.push(a)}})),r),b=n("bc3a"),m=n.n(b);function O(){return m.a}m.a.defaults.baseURL="https://nane.tada.team/api";var d,p;n("99af");function j(e){if(e){var t="".concat("wss://nane.tada.team/ws","?username=").concat(e);if(d){if(d.url===t)return d;d.close()}d=new WebSocket(t),d.onmessage=h}return d}function h(e){var t=JSON.parse(e.data);C.commit(c.ProcessMessage,{roomName:t.room,message:t})}var g,v=O();(function(e){e["Bootstrap"]="BOOTSTRAP",e["FetchSettings"]="FETCH_SETTINGS",e["FetchRooms"]="FETCH_ROOMS",e["FetchHistory"]="FETCH_HISTORY",e["SendMessage"]="SEND_MESSAGE",e["CreateRoom"]="CREATE_ROOM",e["ChangeUsername"]="CHANGE_USERNAME"})(g||(g={}));var S=(p={},Object(o["a"])(p,g.Bootstrap,(function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,r=e.dispatch,a=e.getters,t.next=3,r(g.FetchSettings);case 3:return t.next=5,r(g.FetchRooms);case 5:a.username&&(a.username.trim()?j(a.username):(n(c.SetUsername,void 0),l["a"].push("/login")));case 6:case"end":return t.stop()}}),t)})))()})),Object(o["a"])(p,g.FetchSettings,(function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.prev=1,t.next=4,v.get("settings");case 4:r=t.sent,n(c.SetSettings,s()(r.data.result)),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()})),Object(o["a"])(p,g.FetchRooms,(function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.prev=1,t.next=4,v.get("rooms");case 4:r=t.sent,n(c.SetRooms,s()(r.data.result)),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()})),Object(o["a"])(p,g.FetchHistory,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.prev=1,n.next=4,v.get("rooms/".concat(t,"/history"));case 4:a=n.sent,r(c.SetHistory,s()(a.data.result)),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](1),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()})),Object(o["a"])(p,g.SendMessage,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.roomName,r=t.text,c=j(),c){e.next=4;break}throw new Error("No socket connection");case 4:c.send(JSON.stringify({room:n,text:r}));case 5:case"end":return e.stop()}}),e)})))()})),Object(o["a"])(p,g.CreateRoom,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.dispatch,n.next=3,r(g.SendMessage,{roomName:t,text:"Я создал комнату!"});case 3:case"end":return n.stop()}}),n)})))()})),Object(o["a"])(p,g.ChangeUsername,(function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.commit,r(c.SetUsername,t),j(t);case 3:case"end":return n.stop()}}),n)})))()})),p),k={username:function(e){return e.username},settings:function(e){return e.settings},rooms:function(e){var t;return null===(t=e.rooms)||void 0===t?void 0:t.sort(R)},history:function(e){return e.history},currentRoom:function(e){return e.currentRoom}};function R(e,t){return e.lastMessage.created>t.lastMessage.created?0:1}var w={},y=n("0e44"),x=Object(y["a"])({paths:["username"]}),C=Object(a["a"])({state:w,getters:k,mutations:f,actions:S,plugins:[x]})},a3e1:function(e,t,n){},afbc:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("0613"),c=n("6c02"),a=(n("d3b7"),n("3ca3"),n("ddb0"),[{path:"/",component:function(){return n.e("chunk-88fba9f8").then(n.bind(null,"bb51"))},meta:{requiresAuth:!0}},{path:"/login",component:function(){return Promise.all([n.e("chunk-4debf6f7"),n.e("chunk-2d2086b7")]).then(n.bind(null,"a55b"))}},{path:"/room/:name",component:function(){return Promise.all([n.e("chunk-4debf6f7"),n.e("chunk-2d0c4813")]).then(n.bind(null,"3ab1"))},meta:{requiresAuth:!0}}]),o=Object(c["a"])({history:Object(c["b"])("/nane-client/"),routes:a});o.beforeEach((function(e,t,n){!e.matched.some((function(e){return e.meta.requiresAuth}))||r["c"].getters.username?n():n("/login")}))},c867:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("b05d"),c=(n("c867"),n("b3f7")),a=n("14c0"),o=(n("7d6e"),n("573e"),{config:{},plugins:{},lang:a["a"],iconSet:c["a"]}),u=n("7a23");function i(e,t,n,r,c,a){var o=Object(u["z"])("Header"),i=Object(u["z"])("Sidebar"),s=Object(u["z"])("q-drawer"),l=Object(u["z"])("router-view"),f=Object(u["z"])("q-page-container"),b=Object(u["z"])("q-layout");return Object(u["u"])(),Object(u["e"])(b,{view:"lHh lpR lfr"},{default:Object(u["F"])((function(){return[Object(u["h"])(o,{onToggleClick:e.toggleLeftDrawer},null,8,["onToggleClick"]),"/login"!==e.$route.path?(Object(u["u"])(),Object(u["e"])(s,{key:0,"show-if-above":"",modelValue:e.leftDrawerOpen,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.leftDrawerOpen=t})},{default:Object(u["F"])((function(){return[Object(u["h"])(i)]})),_:1},8,["modelValue"])):Object(u["f"])("",!0),Object(u["h"])(f,null,{default:Object(u["F"])((function(){return[Object(u["h"])(l,{key:e.$route.fullPath})]})),_:1})]})),_:1})}function s(e,t,n,r,c,a){var o=Object(u["z"])("q-btn"),i=Object(u["z"])("q-toolbar-title"),s=Object(u["z"])("q-toolbar"),l=Object(u["z"])("q-header");return Object(u["u"])(),Object(u["e"])(l,{elevated:"",class:"bg-primary text-white"},{default:Object(u["F"])((function(){return[Object(u["h"])(s,null,{default:Object(u["F"])((function(){return["/login"!==e.$route.path?(Object(u["u"])(),Object(u["e"])(o,{key:0,dense:"",flat:"",round:"",icon:"fas fa-bars",onClick:e.toggleClick},null,8,["onClick"])):Object(u["f"])("",!0),Object(u["h"])(i,null,{default:Object(u["F"])((function(){return[Object(u["g"])(Object(u["B"])(e.title),1)]})),_:1}),e.username?(Object(u["u"])(),Object(u["e"])(o,{key:1,label:e.username,onClick:t[1]||(t[1]=function(t){return e.$router.push("/login")}),flat:"","no-caps":"",clickable:""},null,8,["label"])):Object(u["f"])("",!0),e.username?(Object(u["u"])(),Object(u["e"])(o,{key:2,label:"Выйти",onClick:e.logout,flat:"","no-caps":"",clickable:""},null,8,["onClick"])):Object(u["f"])("",!0)]})),_:1})]})),_:1})}n("b0c0");var l=n("0613"),f=n("afbc"),b=Object(u["i"])({name:"Header",emits:["toggleClick"],setup:function(e,t){var n=t.emit,r=Object(u["c"])((function(){return l["c"].getters.username})),c=Object(u["c"])((function(){var e,t=null===(e=l["c"].getters.currentRoom)||void 0===e?void 0:e.name;return t||"Игрушечный чат"}));function a(){n("toggleClick")}function o(){l["c"].commit(l["b"].SetUsername,void 0),f["a"].push("/login")}return{username:r,title:c,toggleClick:a,logout:o}}}),m=n("e359"),O=n("65c6"),d=n("9c40"),p=n("6ac5"),j=n("93dc"),h=n.n(j);b.render=s;var g=b;h()(b,"components",{QHeader:m["a"],QToolbar:O["a"],QBtn:d["a"],QToolbarTitle:p["a"]});var v=Object(u["h"])("span",{class:"text-subtitle1 q-ml-sm"},"Создать комнату",-1);function S(e,t,n,r,c,a){var o=Object(u["z"])("q-icon"),i=Object(u["z"])("q-item-label"),s=Object(u["z"])("q-item-section"),l=Object(u["z"])("q-item"),f=Object(u["z"])("q-list");return Object(u["u"])(),Object(u["e"])(f,{separator:""},{default:Object(u["F"])((function(){return[Object(u["h"])(l,{onClick:e.createRoom,clickable:""},{default:Object(u["F"])((function(){return[Object(u["h"])(s,null,{default:Object(u["F"])((function(){return[Object(u["h"])(i,null,{default:Object(u["F"])((function(){return[Object(u["h"])(o,{name:"fas fa-plus"}),v]})),_:1})]})),_:1})]})),_:1},8,["onClick"]),(Object(u["u"])(!0),Object(u["e"])(u["a"],null,Object(u["y"])(e.rooms,(function(t,n){return Object(u["u"])(),Object(u["e"])(l,{key:"room-".concat(n),active:e.currentRoom===t,"active-class":"bg-indigo-1",onClick:function(n){return e.setActiveRoom(t)},clickable:""},{default:Object(u["F"])((function(){return[Object(u["h"])(s,null,{default:Object(u["F"])((function(){return[Object(u["h"])(i,null,{default:Object(u["F"])((function(){return[Object(u["g"])(Object(u["B"])(t.name),1)]})),_:2},1024),t.lastMessage?(Object(u["u"])(),Object(u["e"])(i,{key:0,caption:""},{default:Object(u["F"])((function(){return[Object(u["g"])(Object(u["B"])(t.lastMessage.text),1)]})),_:2},1024)):Object(u["f"])("",!0)]})),_:2},1024)]})),_:2},1032,["active","onClick"])})),128))]})),_:1})}var k=n("1da1"),R=(n("96cf"),n("498a"),Object(u["i"])({name:"Sidebar",setup:function(){var e=Object(u["c"])((function(){return l["c"].getters.rooms})),t=Object(u["c"])((function(){return l["c"].getters.currentRoom})),n=Object(u["c"])((function(){var e;return null===(e=l["c"].getters.settings)||void 0===e?void 0:e.maxRoomTitleLength}));function r(e){f["a"].push("/room/".concat(e.name))}function c(){return a.apply(this,arguments)}function a(){return a=Object(k["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=null===(t=prompt("Название комнаты",""))||void 0===t?void 0:t.trim(),!r){e.next=11;break}if(!(n.value&&r.length>n.value)){e.next=6;break}alert("Разрешенное кол-во символов: ".concat(n.value)),e.next=9;break;case 6:return e.next=8,l["c"].dispatch(l["a"].CreateRoom,r);case 8:f["a"].push("/room/".concat(r));case 9:e.next=12;break;case 11:alert("Нужен хотя бы один символ!");case 12:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}return{rooms:e,currentRoom:t,maxLength:n,setActiveRoom:r,createRoom:c}}})),w=n("1c1c"),y=n("66e5"),x=n("4074"),C=n("0170"),_=n("0016");R.render=S;var E=R;h()(R,"components",{QList:w["a"],QItem:y["a"],QItemSection:x["a"],QItemLabel:C["a"],QIcon:_["a"]});var T=Object(u["i"])({name:"App",components:{Header:g,Sidebar:E},setup:function(){l["c"].dispatch(l["a"].Bootstrap);var e=Object(u["x"])(!1);function t(){e.value=!e.value}return{leftDrawerOpen:e,toggleLeftDrawer:t}}}),F=n("4d5a"),M=n("9404"),P=n("09e3");T.render=i;var q=T;h()(T,"components",{QLayout:F["a"],QDrawer:M["a"],QPageContainer:P["a"]});n("a3e1");var H=Object(u["d"])(q);H.use(f["a"]),H.use(l["c"]),H.use(r["a"],o),H.mount("#app")}});
//# sourceMappingURL=app.c9949fff.js.map