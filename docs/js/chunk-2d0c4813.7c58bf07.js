(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c4813"],{"3ab1":function(e,t,n){"use strict";n.r(t);var a=n("7a23"),c={key:0,class:"preloader"},r=Object(a["h"])("img",{src:"https://i.gifer.com/origin/b4/b4d657e7ef262b88eb5f7ac021edda87.gif"},null,-1),s={class:"column chat"},o={class:"col chat-history"},u={key:0,class:"col q-pa-md"},l={class:"col chat-input"};function i(e,t,n,i,m,b){var v=Object(a["z"])("q-chat-message"),d=Object(a["z"])("InputPannel"),j=Object(a["z"])("q-page");return Object(a["u"])(),Object(a["e"])(j,null,{default:Object(a["F"])((function(){return[e.isDataReady?Object(a["f"])("",!0):(Object(a["u"])(),Object(a["e"])("div",c,[r])),Object(a["h"])("div",s,[Object(a["h"])("div",o,[Object(a["h"])("div",{class:"chat-scroller",ref:"scroller",onScroll:t[1]||(t[1]=function(){return e.onScroll&&e.onScroll.apply(e,arguments)})},[e.history?(Object(a["u"])(),Object(a["e"])("div",u,[(Object(a["u"])(!0),Object(a["e"])(a["a"],null,Object(a["y"])(e.history,(function(t,n){return Object(a["u"])(),Object(a["e"])(v,{key:"message-".concat(n),name:t.sender.username,text:[t.text],sent:t.sender.username===e.username,stamp:new Date(t.created).toLocaleString("ru"),"bg-color":t.sender.username===e.username?"green-3":"indigo-2"},null,8,["name","text","sent","stamp","bg-color"])})),128))])):Object(a["f"])("",!0)],544)]),Object(a["h"])("div",l,[Object(a["h"])(d,{onMessage:t[2]||(t[2]=function(t){return e.scrollToBottom(!0)})})])])]})),_:1})}var m=n("1da1"),b=(n("96cf"),n("b0c0"),n("7db0"),{class:"input-panel"}),v={class:"message-panel"};function d(e,t,n,c,r,s){var o=Object(a["z"])("q-btn"),u=Object(a["z"])("q-input");return Object(a["u"])(),Object(a["e"])("section",b,[Object(a["h"])("div",v,[Object(a["h"])(u,{class:"message-input bg-primary q-py-xs q-px-md",modelValue:e.message,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.message=t}),placeholder:"Ваше сообщение",autofocus:"",onKeyup:t[3]||(t[3]=Object(a["H"])((function(t){return e.sendMessage()}),["enter"])),borderless:"",dense:"",ref:"input",maxlength:e.maxLength},{after:Object(a["F"])((function(){return[Object(a["h"])(o,{round:"",dense:"",flat:"",icon:"fas fa-paper-plane",onClick:t[1]||(t[1]=function(t){return e.sendMessage()})})]})),_:1},8,["modelValue","maxlength"])])])}var j=n("0613"),O=Object(a["i"])({name:"InputPanel",emits:["message"],setup:function(e,t){var n=t.emit,c=Object(a["c"])((function(){var e;return null===(e=j["c"].getters.settings)||void 0===e?void 0:e.maxMessageLength})),r=Object(a["c"])((function(){return j["c"].getters.currentRoom})),s=Object(a["c"])((function(){return j["c"].getters.history})),o=Object(a["x"])(null),u=Object(a["x"])(null);function l(){var e;null===(e=u.value)||void 0===e||e.focus()}function i(){o.value&&r.value&&(j["c"].dispatch(j["a"].SendMessage,{roomName:r.value.name,text:o.value}),n("message"),o.value=null,l())}return{maxLength:c,history:s,message:o,input:u,sendMessage:i}}}),g=n("27f9"),p=n("9c40"),f=n("93dc"),h=n.n(f);O.render=d;var x=O;h()(O,"components",{QInput:g["a"],QBtn:p["a"]});var k=n("afbc"),q=Object(a["i"])({name:"Room",components:{InputPannel:x},setup:function(){var e=k["a"].currentRoute.value.params.name,t=Object(a["c"])((function(){return j["c"].getters.username})),n=Object(a["c"])((function(){return j["c"].getters.rooms})),c=Object(a["c"])((function(){return j["c"].getters.history})),r=Object(a["c"])((function(){var e;return null===(e=c.value)||void 0===e?void 0:e.length})),s=Object(a["x"])(null),o=Object(a["x"])(!0),u=Object(a["x"])(!1);function l(){if(s.value){var e=s.value.scrollHeight-s.value.clientHeight;o.value=s.value.scrollTop===e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s.value&&(e||o.value)&&(s.value.scrollTop=s.value.scrollHeight)}return Object(a["s"])(Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,j["c"].dispatch(j["a"].FetchHistory,e);case 2:setTimeout((function(){i(!0),u.value=!0}),500);case 3:case"end":return t.stop()}}),t)})))),Object(a["p"])((function(){j["c"].commit(j["b"].SetCurrentRoom,void 0),j["c"].commit(j["b"].SetHistory,void 0)})),Object(a["D"])((function(){return r.value}),Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["n"])();case 2:i();case 3:case"end":return e.stop()}}),e)})))),Object(a["E"])((function(){var t,a=null===(t=n.value)||void 0===t?void 0:t.find((function(t){return t.name===e}));a&&j["c"].commit(j["b"].SetCurrentRoom,a)})),{username:t,history:c,scroller:s,isDataReady:u,onScroll:l,scrollToBottom:i}}}),y=n("9989"),H=n("ade3"),S=(n("d81d"),n("cdf5")),w=Object(a["i"])({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup:function(e,t){var n=t.slots,c=Object(a["c"])((function(){return!0===e.sent?"sent":"received"})),r=Object(a["c"])((function(){return"q-message-text-content q-message-text-content--".concat(c.value)+(void 0!==e.textColor?" text-".concat(e.textColor):"")})),s=Object(a["c"])((function(){return"q-message-text q-message-text--".concat(c.value)+(void 0!==e.bgColor?" text-".concat(e.bgColor):"")})),o=Object(a["c"])((function(){return"q-message-container row items-end no-wrap"+(!0===e.sent?" reverse":"")})),u=Object(a["c"])((function(){return void 0!==e.size?"col-".concat(e.size):""})),l=Object(a["c"])((function(){return{msg:!0===e.textHtml?"innerHTML":"textContent",stamp:!0===e.stampHtml?"innerHTML":"textContent",name:!0===e.nameHtml?"innerHTML":"textContent",label:!0===e.labelHtml?"innerHTML":"textContent"}}));function i(){var t=e.stamp?function(t){return[t,Object(a["k"])("div",Object(H["a"])({class:"q-message-stamp"},l.value.stamp,e.stamp))]}:function(e){return[e]};return e.text.map((function(e,n){return Object(a["k"])("div",{key:n,class:s.value},[Object(a["k"])("div",{class:r.value},t(Object(a["k"])("div",Object(H["a"])({},l.value.msg,e))))])}))}function m(){var t=Object(S["d"])(n.default,[]);return void 0!==e.stamp&&t.push(Object(a["k"])("div",Object(H["a"])({class:"q-message-stamp"},l.value.stamp,e.stamp))),Object(a["k"])("div",{class:s.value},[Object(a["k"])("div",{class:"q-message-text-content "+r.value},t)])}return function(){var t=[];void 0!==n.avatar?t.push(n.avatar()):void 0!==e.avatar&&t.push(Object(a["k"])("img",{class:"q-message-avatar q-message-avatar--".concat(c.value),src:e.avatar,"aria-hidden":"true"}));var r=[];void 0!==e.name&&r.push(Object(a["k"])("div",Object(H["a"])({class:"q-message-name q-message-name--".concat(c.value)},l.value.name,e.name))),void 0!==e.text&&r.push(i()),void 0!==n.default&&r.push(m()),t.push(Object(a["k"])("div",{class:u.value},r));var s=[];return e.label&&s.push(Object(a["k"])("div",Object(H["a"])({class:"q-message-label text-center"},l.value.label,e.label))),s.push(Object(a["k"])("div",{class:o.value},t)),Object(a["k"])("div",{class:"q-message q-message-".concat(c.value)},s)}}});q.render=i;t["default"]=q;h()(q,"components",{QPage:y["a"],QChatMessage:w})}}]);
//# sourceMappingURL=chunk-2d0c4813.7c58bf07.js.map